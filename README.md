# DTA-OM

A Pytorch Implementation of paper:

**Drug--Target Affinity Prediction via Optimized Protein Language Embeddings and Multi-Modal Molecular Representations**

Jia Mi, Jinghong Sun, Chang Li, Jing Wan



Accurate prediction of drugâ€“target affinity (DTA) is essential for drug screening, mechanism analysis, and personalized therapy. Despite advances in deep learning-based DTA models, challenges remain in target representation, high-dimensional redundancy of large model embeddings, and shallow interaction modeling. In this study, we propose a novel affinity prediction framework that integrates protein language embeddings with multi-modal molecular features to enhance both representation and interaction modeling. Specifically, protein embeddings generated by ProtBert and ESM-2 are denoised and compressed via principal component analysis (PCA), then fused with local features extracted by convolutional neural networks (CNNs) to capture multi-scale semantic information. On the drug side, molecular graphs, Morgan fingerprints, Avalon fingerprints, and MACCS keys are jointly encoded using an attention-guided multi-modal fusion module. To refine interaction modeling, we introduce a staged mechanism combining cross-attention and self-attention to capture fine-grained binding patterns and interaction strengths. Extensive experiments on benchmark datasets including Davis and KIBA demonstrate that our model significantly outperforms competitive baselines under strict Novel-pair, Novel-drug, and Novel-protein settings. Downstream classification tasks and ablation studies further confirm the contributions of protein language models and MACCS features. Case studies with molecular docking validate the predicted interactions at both structural and energetic levels, highlighting the practical potential of our approach.

## 0. Overview of MTAF-DTA

![fig.1](fig.1.jpg)

Set up the environment:

In our experiment we use, Python 3.8.0 with PyTorch  2.0.1.

```
git clone https://github.com/MiJia-ID/DTA-OM.git
conda env create -f environment.yml
```

# 1. Dataset

The data should be in the format .csv: 'smiles', 'target_sequences', 'affinity'.

# 2. How to train

```
nohup python train.py 2>save_result/train&
```

# 3. To train YOUR model:

Your data should be in the format .csv, and the column names are: 'smiles', 'target_sequences', 'affinity'.

Generate the drug feature file from the given document using the [AMF.py](https://github.com/MiJia-ID/AMF.py)

Then you can freely tune the hyperparameter for your best performance.

